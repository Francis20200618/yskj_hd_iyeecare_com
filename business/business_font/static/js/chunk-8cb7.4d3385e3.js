(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-8cb7"],{"0DFP":function(t,e,l){},"Gq+J":function(t,e,l){"use strict";var i=l("0DFP");l.n(i).a},"MFt+":function(t,e,l){"use strict";l.r(e);var i=l("bS4n"),o=l.n(i),s={components:{uploadImg:l("ErL5").a},data:function(){return{id:0,form:{title:"",reply_type:0},h5_form:{title:"",url:"",weapp_id:"",weapp_url:""},img_form:{url:""},rule_list:[],reply_content_list:[],reply_content_tmp:"",reply_content_index:-1,dialog_show:!1,h5_dialog_show:!1,img_dialog_show:!1,submit_url:"",is_edit:!1,uploadShow:!1,rules:{title:{required:!0,message:"请输入规则名称"}}}},created:function(){},mounted:function(){this.id=this.$route.query.id,this.id?this.getData():this.rule_list.push(this.buildRuleItem(1,""))},methods:{goParent:function(){this.$router.push(this.fun.getUrl("serviceWordsReplyList"))},getData:function(){var t=this;$http.pc_post("plugin/YunChat/wordsReplyGetDetail",{id:this.id},"loading").then(function(e){e.result?(t.form=o()({},e.data),t.form.group_id||(t.form.group_id=""),e.data.rule_list&&e.data.rule_list.length>0?t.rule_list=e.data.rule_list:t.rule_list.push(t.buildRuleItem(1,"")),t.reply_content_list=e.data.reply_content_list):t.$message({message:e.msg,type:"error"})},function(e){t.$message({message:e.msg,type:"error"})})},submitForm:function(t){var e=this;if(this.form.title)if(this.form.title.length>20)this.$message({message:"规则名称最多20个字",type:"error"});else{for(var l=!1,i=!1,o=0;o<this.rule_list.length;o++)if(this.rule_list[o].word){l=!0;break}for(var s=0;s<this.reply_content_list.length;s++)if(this.reply_content_list[s]){i=!0;break}if(l)if(i){var r={title:this.form.title,rule_list:this.rule_list,reply_content_list:this.reply_content_list,reply_type:this.form.reply_type};this.id&&(r.id=this.id),$http.pc_post("plugin/YunChat/wordsReplySave",r,"loading").then(function(t){t.result?(e.$message({type:"success",message:"操作成功!"}),e.goBack()):e.$message({message:t.msg,type:"error"})},function(t){})}else this.$message({message:"至少要有一个回复内容",type:"error"});else this.$message({message:"至少要有一个关键词",type:"error"})}else this.$message({message:"请输入规则名称",type:"error"})},goBack:function(){history.go(-1)},addRuleWord:function(){this.rule_list.push(this.buildRuleItem(1,""))},removeRuleWord:function(t){var e=[],l=this.rule_list.length;if(l<=1)this.$message({message:"至少要有一个关键词",type:"error"});else{for(var i=0;i<l;i++)i!=t&&e.push(this.rule_list[i]);this.rule_list=e}},addReplyShow:function(){this.dialog_show=!0},saveReplyContent:function(){if(this.reply_content_index>=0){for(var t=[],e=this.reply_content_list.length,l=0;l<e;l++)l==this.reply_content_index?t.push(this.reply_content_tmp):t.push(this.reply_content_list[l]);this.reply_content_list=t}else this.reply_content_list.push(this.reply_content_tmp);this.dialog_show=!1,this.reply_content_tmp="",this.reply_content_index=-1},removeReplyContent:function(t){for(var e=[],l=this.reply_content_list.length,i=0;i<l;i++)i!=t&&e.push(this.reply_content_list[i]);this.reply_content_list=e},editReplyContent:function(t){for(var e=this.reply_content_list.length,l=0;l<e;l++)if(l==t){this.reply_content_tmp=this.reply_content_list[l];break}this.reply_content_index=t,this.dialog_show=!0},buildRuleItem:function(t,e){return{type:t,word:e}},addNickName:function(){this.insertVariable("#会员昵称#")},h5DialogShow:function(){this.h5_dialog_show=!0},imgDialogShow:function(){this.img_dialog_show=!0},addH5Link:function(){var t='<link href="'+this.h5_form.url+'" weapp_id="'+this.h5_form.weapp_id+'" weapp_url="'+this.h5_form.weapp_url+'">'+this.h5_form.title+"</link>";this.insertVariable(t),this.h5_dialog_show=!1},openUpload:function(){this.uploadShow=!0},sureImg:function(t){this.img_form.url=t},addImgEle:function(){var t='<img src="'+this.img_form.url+'" />';this.insertVariable(t),this.img_dialog_show=!1},insertVariable:function(t){var e=document.querySelector("#reply_content"),l=e.selectionStart,i=e.selectionEnd;this.reply_content_tmp=e.value.substring(0,l)+t+e.value.substring(i,e.value.length),e.focus()}}},r=(l("Gq+J"),l("ZrdR")),n=Object(r.a)(s,function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"all"},[l("div",{attrs:{id:"app"}},[l("div",{staticClass:"vue-crumbs"},[l("a",{on:{click:function(e){t.goParent()}}},[t._v("关键词回复")]),t._v(" > 编辑关键词回复\n    ")]),t._v(" "),l("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"15%"}},[l("div",{staticClass:"vue-main"},[l("div",{staticClass:"vue-main-title"},[l("div",{staticClass:"vue-main-title-left"}),t._v(" "),l("div",{staticClass:"vue-main-title-content"},[t._v("编辑关键词回复")])]),t._v(" "),l("div",{staticClass:"vue-main-form"},[l("el-form-item",{attrs:{label:"规则名称",prop:"nickname"}},[l("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"输入规则名称"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}}),t._v(" "),l("div",{staticClass:"tip"},[t._v("规则名称最多20个字")])],1),t._v(" "),l("el-form-item",{attrs:{label:"关键词匹配",prop:"rule_list"}},t._l(t.rule_list,function(e,i){return l("div",{staticStyle:{"margin-left":"30px","margin-bottom":"10px"}},[l("el-select",{model:{value:t.rule_list[i].type,callback:function(e){t.$set(t.rule_list[i],"type",e)},expression:"rule_list[i]['type']"}},[l("el-option",{attrs:{value:1,label:"半匹配"}}),t._v(" "),l("el-option",{attrs:{value:2,label:"全匹配"}})],1),t._v(" "),l("el-input",{staticStyle:{width:"40%"},attrs:{placeholder:"请输入关键词"},model:{value:t.rule_list[i].word,callback:function(e){t.$set(t.rule_list[i],"word",e)},expression:"rule_list[i]['word']"}}),t._v(" "),l("span",{staticStyle:{"font-size":"22px"}},[i==t.rule_list.length-1?l("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{cursor:"pointer"},on:{click:t.addRuleWord}}):t._e(),t._v(" "),t.rule_list.length>1?l("i",{staticClass:"el-icon-remove-outline",staticStyle:{cursor:"pointer"},on:{click:function(e){t.removeRuleWord(i)}}}):t._e()])],1)})),t._v(" "),l("el-form-item",{attrs:{label:"回复内容",prop:"reply_content_list"}},[l("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addReplyShow()}}},[t._v("添加内容")]),t._v(" "),t.reply_content_list&&t.reply_content_list.length>0?l("el-table",{staticStyle:{width:"70%"},attrs:{data:t.reply_content_list,"show-header":!1}},[l("el-table-column",{attrs:{label:"内容"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(e.row)+"\n                ")]}}])}),t._v(" "),l("el-table-column",{attrs:{prop:"refund_time",label:"操作",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("i",{staticClass:"iconfont icon-ht_operation_delete",staticStyle:{cursor:"pointer","margin-right":"10px"},on:{click:function(l){t.removeReplyContent(e.$index)}}}),t._v(" "),l("i",{staticClass:"iconfont icon-ht_operation_edit",staticStyle:{cursor:"pointer"},on:{click:function(l){t.editReplyContent(e.$index)}}})]}}])})],1):t._e()],1),t._v(" "),l("el-form-item",{attrs:{label:"回复方式",prop:"reply_type"}},[l("el-radio",{attrs:{label:0},model:{value:t.form.reply_type,callback:function(e){t.$set(t.form,"reply_type",e)},expression:"form.reply_type"}},[t._v("随机一条")]),t._v(" "),l("el-radio",{attrs:{label:1},model:{value:t.form.reply_type,callback:function(e){t.$set(t.form,"reply_type",e)},expression:"form.reply_type"}},[t._v("全部回复")])],1)],1)])]),t._v(" "),l("el-dialog",{attrs:{title:"添加回复内容",visible:t.dialog_show,"close-on-click-modal":!1,width:"60%"},on:{"update:visible":function(e){t.dialog_show=e}}},[l("div",[l("el-input",{attrs:{type:"textarea",id:"reply_content",rows:5},model:{value:t.reply_content_tmp,callback:function(e){t.reply_content_tmp=e},expression:"reply_content_tmp"}}),t._v(" "),l("div",{staticClass:"reply_content_tag"},[l("span",{on:{click:t.addNickName}},[t._v("#会员昵称#")]),t._v(" "),l("span",{on:{click:t.imgDialogShow}},[t._v("#图片#")]),t._v(" "),l("span",{on:{click:t.h5DialogShow}},[t._v("#链接#")])])],1),t._v(" "),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{type:"primary"},on:{click:t.saveReplyContent}},[t._v("确定")]),t._v(" "),l("el-button",{on:{click:function(e){t.dialog_show=!1}}},[t._v("取 消")])],1)]),t._v(" "),l("el-dialog",{attrs:{title:"添加链接",visible:t.h5_dialog_show,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(e){t.h5_dialog_show=e}}},[l("div",[l("el-form",{ref:"h5_form",attrs:{model:t.h5_form,"label-width":"15%"}},[l("el-form-item",{attrs:{label:"链接标题",prop:"h5_form_title"}},[l("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"请输入标题"},model:{value:t.h5_form.title,callback:function(e){t.$set(t.h5_form,"title",e)},expression:"h5_form.title"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"链接H5地址",prop:"h5_form_url"}},[l("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"请以https://开头"},model:{value:t.h5_form.url,callback:function(e){t.$set(t.h5_form,"url",e)},expression:"h5_form.url"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"小程序原始ID",prop:"h5_form_weapp_id"}},[l("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"请填写跳转的小程序以gh_开头的原始id"},model:{value:t.h5_form.weapp_id,callback:function(e){t.$set(t.h5_form,"weapp_id",e)},expression:"h5_form.weapp_id"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"小程序路径",prop:"h5_form_weapp_url"}},[l("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"请输入小程序路径"},model:{value:t.h5_form.weapp_url,callback:function(e){t.$set(t.h5_form,"weapp_url",e)},expression:"h5_form.weapp_url"}})],1)],1)],1),t._v(" "),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{type:"primary"},on:{click:t.addH5Link}},[t._v("确定")]),t._v(" "),l("el-button",{on:{click:function(e){t.h5_dialog_show=!1}}},[t._v("取 消")])],1)]),t._v(" "),l("el-dialog",{attrs:{title:"添加图片",visible:t.img_dialog_show,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(e){t.img_dialog_show=e}}},[l("div",[l("el-form",{ref:"h5_form",attrs:{model:t.img_form,"label-width":"15%"}},[l("el-form-item",{attrs:{label:"选择图片"}},[l("el-input",{staticStyle:{width:"65%"},attrs:{disabled:!0},model:{value:t.img_form.url,callback:function(e){t.$set(t.img_form,"url",e)},expression:"img_form.url"}}),t._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:t.openUpload}},[t._v("选择图片")])],1)],1)],1),t._v(" "),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{type:"primary"},on:{click:t.addImgEle}},[t._v("确定")]),t._v(" "),l("el-button",{on:{click:function(e){t.img_dialog_show=!1}}},[t._v("取 消")])],1)]),t._v(" "),l("div",{staticClass:"vue-page"},[l("div",{staticClass:"vue-center"},[l("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("form")}}},[t._v("提交")]),t._v(" "),l("el-button",{on:{click:t.goBack}},[t._v("返回")])],1)]),t._v(" "),l("upload-img",{attrs:{centerDialogVisible:t.uploadShow},on:{changeVisible:function(e){t.uploadShow=!1},sureImg:t.sureImg}})],1)])},[],!1,null,"767b6e76",null);n.options.__file="wordsReply_detail.vue";e.default=n.exports}}]);