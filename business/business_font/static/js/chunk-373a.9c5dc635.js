(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-373a"],{Ko3s:function(e,t,a){"use strict";a.r(t);var r={components:{staff_side:a("3vhb").a},data:function(){return{form:{uid:"",name:"",gender:0,alias:"",department_id:[],mobile:"",telephone:"",email:"",address:"",position:""},staff_id:0,department_list:[],member_keyword:"",choosed_member:{},member_list:[],member_show:!1,department_disabled_name:"",rules:{name:[{required:!0,message:"请项为必填项",trigger:"blur"}],department_id:[{required:!0,message:"请项为必填项",trigger:"blur"}],mobile:[{required:!0,message:"请项为必填项",trigger:"blur"}],telephone:[{required:!0,message:"请项为必填项",trigger:"blur"}],email:[{required:!0,message:"请项为必填项",trigger:"blur"}],address:[{required:!0,message:"请项为必填项",trigger:"blur"}],position:[{required:!0,message:"请项为必填项",trigger:"blur"}],uid:[{required:!0,message:"请项为必填项",trigger:"blur"}]},member_search_options:[{value:"mobile",label:"手机号码"},{value:"uid",label:"会员ID"}],member_search_value:"mobile",member_search_label:"手机号码"}},created:function(){this.$route.query&&this.$route.query.staff_id?(this.staff_id=this.$route.query.staff_id,this.department_disabled_name="update_staff_disabled",this.getStaffInfo()):this.department_disabled_name="create_staff_disabled",this.getDepartmentList()},methods:{checkForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.onSubmit()})},memberChange:function(e){var t=this.member_search_options.find(function(t){return t.value==e});this.member_search_label=t.label},goBack:function(){this.$router.go(-1)},onSubmit:function(){var e=this,t="admin/createStaff";this.staff_id>0&&(this.form.is_edit=1,t="admin/updateStaff"),$http.pc_post(t,this.form,"loading").then(function(t){1===t.result?t.msg&&(e.$message.success(t.msg),setTimeout(function(){e.$router.push(e.fun.getUrl("staffIndex"))},1e3)):t.msg&&e.$message.error(t.msg)}).catch(function(e){console.error(e)})},getStaffInfo:function(){var e=this;$http.pc_get("admin/updateStaff",{id:this.staff_id},"loading").then(function(t){1===t.result?(console.log(t.data.staff),e.form=t.data.staff,e.choosed_member=t.data.staff.has_one_member):t.msg&&e.$message.error(t.msg)}).catch(function(e){console.error(e)})},getDepartmentList:function(){var e=this;$http.pc_get("admin/getDepatmemtList",{},"loading").then(function(t){1===t.result?(e.department_list=t.data.list,console.log(e.department_list)):t.msg&&e.$message.error(t.msg)}).catch(function(e){console.error(e)})},openMember:function(){this.member_show=!0},getMember:function(){var e=this;$http.pc_get("admin/businessGetMemberByMobile",{search:this.member_keyword,search_type:this.member_search_value}).then(function(t){t.result?e.member_list=t.data:e.$message({type:"error",message:t.msg})},function(t){e.$message({type:"error",message:t.msg})})},chooseMember:function(e){this.choosed_member=e,this.form.uid=e.uid,this.member_show=!1,console.log(this.form)},clearMember:function(){this.choosed_member={},this.form.uid="",this.$forceUpdate()}}},i=(a("g30G"),a("KHd+")),s=Object(i.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"staff"},[a("staff_side"),e._v(" "),a("div",{staticClass:"staff-right-box"},[a("div",{staticStyle:{"font-size":"14px",color:"#333","padding-bottom":"10px"}},[e._v("\n      成员管理>成员"+e._s(0==e.staff_id?"创建":"编辑")+"\n    ")]),e._v(" "),a("div",{staticClass:"staff-right-container"},[e._m(0),e._v(" "),a("div",{staticClass:"main"},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"15%"}},[a("div",{staticClass:"vue-main-form"},[0!=e.staff_id?a("el-form-item",{attrs:{label:"userid"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{disabled:!0,placeholder:""},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"成员姓名",prop:"name"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门",prop:"department_id"}},[a("el-cascader",{staticStyle:{width:"70%"},attrs:{options:e.department_list,props:{multiple:!0,checkStrictly:!0,label:"name",value:"id",children:"has_one_sub_department",disabled:e.department_disabled_name},clearable:""},model:{value:e.form.department_id,callback:function(t){e.$set(e.form,"department_id",t)},expression:"form.department_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:""},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"座机"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:""},model:{value:e.form.telephone,callback:function(t){e.$set(e.form,"telephone",t)},expression:"form.telephone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:""},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"地址",prop:"address"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:""},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"职务",prop:"position"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:""},model:{value:e.form.position,callback:function(t){e.$set(e.form,"position",t)},expression:"form.position"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"会员",prop:"uid"}},[e.form.uid?e._e():a("div",{staticClass:"upload-box",on:{click:e.openMember}},[a("div",{staticClass:"upload-box-member"},[a("i",{staticClass:"el-icon-plus",staticStyle:{"font-size":"32px"}}),a("br"),e._v("\n                  选 择\n                ")])]),e._v(" "),e.form.uid?a("div",{staticClass:"upload-boxed"},[a("img",{staticStyle:{width:"150px",height:"150px","border-radius":"5px",cursor:"pointer"},attrs:{src:e.choosed_member.avatar_image,alt:""},on:{click:e.openMember}}),e._v(" "),a("div",{staticClass:"upload-boxed-text"},[e._v("重新选择")]),e._v(" "),a("div",{staticClass:"upload-boxed-text-clear",on:{click:function(t){e.clearMember("uid")}}},[e._v("\n                  清除选择\n                ")]),e._v(" "),a("div",{staticStyle:{"text-align":"center","line-height":"20px"}},[e._v("\n                  "+e._s(e.choosed_member.nickname)+"\n                ")])]):e._e()]),e._v(" "),a("el-form-item",[a("div",{staticStyle:{height:"20px"}}),e._v(" "),a("el-button",{staticStyle:{background:"#5ab79c","border-color":"#5ab79c"},attrs:{type:"primary"},on:{click:function(t){e.checkForm("form")}}},[e._v("提交")]),e._v(" "),a("el-button",{on:{click:e.goBack}},[e._v("取消")])],1)],1)])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"选择会员",visible:e.member_show,width:"60%"},on:{"update:visible":function(t){e.member_show=t}}},[a("div",[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.memberChange},model:{value:e.member_search_value,callback:function(t){e.member_search_value=t},expression:"member_search_value"}},e._l(e.member_search_options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"请输入"+e.member_search_label},model:{value:e.member_keyword,callback:function(t){e.member_keyword=t},expression:"member_keyword"}}),e._v(" "),a("el-button",{on:{click:e.getMember}},[e._v("搜索")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%",height:"500px",overflow:"auto"},attrs:{data:e.member_list}},[a("el-table-column",{attrs:{label:"ID",prop:"uid",align:"center",width:"100px"}}),e._v(" "),a("el-table-column",{attrs:{label:"会员信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{display:"flex","align-items":"center"}},[t.row.avatar_image?a("div",{staticStyle:{width:"40px"}},[a("el-image",{staticStyle:{width:"40px",height:"40px","border-radius":"50%"},attrs:{src:t.row.avatar_image,alt:""}})],1):e._e(),e._v(" "),a("div",{staticStyle:{flex:"1"}},[e._v("\n                【id:"+e._s(t.row.uid)+"】"+e._s(t.row.nickname)+"\n              ")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"refund_time",label:"操作",align:"center",width:"320"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){e.chooseMember(t.row)}}},[e._v("\n              选择\n            ")])]}}])})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.member_show=!1}}},[e._v("取 消")])],1)],1)],1)],1)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header"},[t("div",{staticClass:"header-title"},[t("span"),t("b",[this._v("员工管理")])])])}],!1,null,"6a75a433",null);s.options.__file="staff_edit.vue";t.default=s.exports},g30G:function(e,t,a){"use strict";var r=a("i9wM");a.n(r).a},i9wM:function(e,t,a){}}]);