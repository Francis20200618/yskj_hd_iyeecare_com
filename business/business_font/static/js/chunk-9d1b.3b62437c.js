(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-9d1b"],{"/f1G":function(e,t,a){e.exports={default:a("nhzr"),__esModule:!0}},E8gZ:function(e,t,a){var s=a("jmDH"),i=a("w6GO"),r=a("NsO/"),n=a("NV0k").f;e.exports=function(e){return function(t){for(var a,c=r(t),o=i(c),l=o.length,u=0,_=[];l>u;)a=o[u++],s&&!n.call(c,a)||_.push(e?[a,c[a]]:c[a]);return _}}},QOMK:function(e,t,a){"use strict";a.r(t);var s=a("QbLZ"),i=a.n(s),r=a("jo6Y"),n=a.n(r),c=a("/f1G"),o=a.n(c),l=a("14Xm"),u=a.n(l),_=a("D3Ub"),p=a.n(_),d=a("fb88"),m=a("TXmZ"),h=a("YEIV"),v=a.n(h),f={props:{selectMemberVisible:{type:Boolean,default:!1},axiosUrl:{type:String,default:""},titleName:{type:String,default:"成员"}},components:{},data:function(){return{search:{kwd:""},tableData:[],oneShow:!1,valueName:"kwd"}},computed:{},created:function(){},mounted:function(){this.getActivityList()},methods:{searchs:function(){this.getActivityList()},select:function(e){e&&this.$emit("selectMemberData",{data:e,titleName:this.titleName}),this.$emit("selectMemberList",!1)},getActivityList:function(){var e=this;return p()(u.a.mark(function t(){var a,s;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.titleName,t.next="群聊"===t.t0?3:"成员"===t.t0?5:"群主"===t.t0?7:"群标签"===t.t0?9:"群成员"===t.t0?11:13;break;case 3:return e.valueName="keyword",t.abrupt("break",14);case 5:return e.valueName="kwd",t.abrupt("break",14);case 7:return e.valueName="staff_info",t.abrupt("break",14);case 9:return e.valueName="tag_name",t.abrupt("break",14);case 11:return e.valueName="kwd",t.abrupt("break",14);case 13:return t.abrupt("break",14);case 14:return a=new Object,a="成员"==e.titleName||"群成员"==e.titleName?v()({},e.valueName,e.search.kwd):{search:v()({},e.valueName,e.search.kwd)},t.next=18,$http.pc_post(e.axiosUrl,i()({},a),"loading");case 18:1==(s=t.sent).result?(e.tableData=s.data,e.oneShow||e.$emit("memberList",e.tableData),e.oneShow=!0):(e.$message.error(s.msg),e.oneShow=!0);case 20:case"end":return t.stop()}},t,e)}))()}}},b=(a("gzmU"),a("KHd+")),g=Object(b.a)(f,function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.oneShow?a("div",{staticClass:"group_coupon_dialog"},[a("el-dialog",{attrs:{center:"",title:"选择"+e.titleName,visible:e.selectMemberVisible,"before-close":e.select,width:"50%"},on:{"update:visible":function(t){e.selectMemberVisible=t}}},[a("div",{staticStyle:{display:"flex",width:"95%"}},[a("el-input",{attrs:{placeholder:"选择"+e.titleName+"名称/手机号"},model:{value:e.search.kwd,callback:function(t){e.$set(e.search,"kwd",t)},expression:"search.kwd"}}),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.searchs}},[e._v("搜索")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%",height:"500px","overflow-y":"auto"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{align:"center",prop:"id",label:"ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:""+e.titleName=="成员"?"name":""+e.titleName=="群聊"?"group_name":""+e.titleName=="群主"?"name":""+e.titleName=="群标签"?"tag_name":"name",align:"center",label:e.titleName+"名称"}}),e._v(" "),""+e.titleName=="成员"?a("el-table-column",{attrs:{prop:"mobile",align:"center",label:"手机号码"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{plain:""},on:{click:function(a){e.select(t.row)}}},[e._v("选择")])]}}])})],1)],1)],1):e._e()},[],!1,null,"43469422",null);g.options.__file="select_member_dialog.vue";var y=g.exports,x={components:{sop_manage_side:d.a,content_card:m.a,select_member_dialog:y},data:function(){return{form:{name:"",is_open:!0,execution_type:1},search:{group_type:1,target_type:1,send_date_type:1,end_date:"",after_hour:"",after_min:"",target_list:[],exclude_group:[],executor:[]},time_day1:"",time_day2:"",time_hour1:"",time_hour2:"",dataShowList:[],testSlogan:"感谢您的关注，我们将竭诚为您服务!",nicknameList:[{name:"客户昵称",value:"{{客户昵称}}"}],styleContext:{position:"absolute",right:0,top:"-120px",height:"622px"},avatar:"",info_show:!0,selectMemberVisible:!1,axiosUrl:"",activity_basis_form:[],tabName:"",isShowExcludeRroup:!1,groupNum:"",isShowGroupNum:!1}},mounted:function(){this.$route.query.id&&this.getTaskDetail()},watch:{"search.target_list":{handler:function(e){this.isShowGroupNum=!1},deep:!0},"search.exclude_group":{handler:function(e){this.isShowGroupNum=!1},deep:!0}},methods:{getTaskDetail:function(){var e=this;return p()(u.a.mark(function t(){var a;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.info_show=!1,t.next=3,$http.pc_post("plugin/SopTask/getTaskDetail",{id:e.$route.query.id});case 3:(a=t.sent).result?(e.form.name=a.data.name,e.form.is_open=a.data.is_open,e.form.execution_type=a.data.execution_type[0],e.search=a.data.task_set,1==a.data.task_set.send_date_type?e.time_day1=a.data.task_set.time_day:e.time_day2=a.data.task_set.time_day,1==a.data.task_set.send_date_type?e.time_hour1=a.data.task_set.time_hour:e.time_hour2=a.data.task_set.time_hour,e.$set(e.search,"executor",a.data.executor),e.dataShowList=a.data.content_list,e.info_show=!0):(e.$message.error(a.msg),e.info_show=!0);case 5:case"end":return t.stop()}},t,e)}))()},getMemberList:function(e){},openChoice:function(e,t){switch(this.isShowExcludeRroup=t,this.titleName=e,e){case"群聊":this.axiosUrl="plugin/SopTask/searchGroupChat";break;case"成员":this.axiosUrl="plugin/SopTask/searchStaff";break;case"群主":this.axiosUrl="plugin/SopTask/searchGroupLeader";break;case"群标签":this.axiosUrl="plugin/GroupDevelopUser/getAllTag";break;case"群成员":this.axiosUrl="plugin/SopTask/searchStaff"}this.selectMemberVisible=!0},selectMemberList:function(e){this.selectMemberVisible=e},getSelectMemberData:function(e){switch(e.titleName){case"群聊":this.isShowExcludeRroup?this.tabName="exclude_group":this.tabName="target_list";break;case"群成员":case"群标签":case"群主":this.tabName="target_list"}o()(e.data).length>0&&(0==this.search["成员"==e.titleName?"executor":this.tabName].filter(function(t){return t.id==e.data.id}).length&&this.search["成员"==e.titleName?"executor":this.tabName].push(e.data))},changeRadioType:function(){this.search.target_list=[],1==this.search.group_type&&(this.search.exclude_group=[])},delSelectMembers:function(e,t){this.search[t].splice(e,1)},changeRadio:function(e){switch(e){case 1:this.time_day2="",this.time_hour2="",this.search.end_date="",this.search.after_hour="",this.search.after_min="";break;case 2:this.time_day1="",this.time_hour1="",this.search.end_date="",this.search.after_hour="",this.search.after_min="";break;case 3:this.time_day2="",this.time_hour2="",this.time_day1="",this.time_hour1="",this.search.end_date=""}},submit:function(e,t){var a=this;return p()(u.a.mark(function s(){var r,c,o,l,_,p,d;return u.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return r=a.search,r.executor,c=n()(r,["executor"]),o=i()({task_type:4},a.form,{executor:a.search.executor,task_set:i()({},c,{time_day:1==a.search.send_date_type?a.time_day1:a.time_day2,time_hour:1==a.search.send_date_type?a.time_hour1:a.time_hour2}),content_list:i()({},a.$refs.content_card.submitData)}),l=o.executor.map(function(e){return{id:e.id}}),o.executor=l,_=a.search.exclude_group.map(function(e){return{id:e.id}}),o.task_set.exclude_group=_,p=a.search.target_list.map(function(e){return{id:e.id}}),o.task_set.target_list=p,o.execution_type=[o.execution_type],s.next=11,$http.pc_post(e,{id:a.$route.query.id,form:i()({},o)},"loading");case 11:1==(d=s.sent).result?(a.$message.success(d.msg),"checkNum"==t?(a.groupNum=d.data.length,a.isShowGroupNum=!0):a.$router.push(a.fun.getUrl("groupSop",{},{}))):a.$message.error(d.msg);case 13:case"end":return s.stop()}},s,a)}))()},changeInput:function(e,t){Number(this.search[t])<0&&(this.search[t]=0),"time_day1"!==t&&"time_day2"!==t&&(Number(this.search[t])>24&&"after_hour"==t&&(this.search[t]=24),Number(this.search[t])>60&&"after_min"==t&&(this.search[t]=60))}}},k=(a("eKCi"),Object(b.a)(x,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"all"},[a("sop_manage_side",{attrs:{defaultActive:"groupSop"}}),e._v(" "),a("div",{staticStyle:{width:"calc(100% - 150px)"},attrs:{id:"app"}},[a("div",{staticClass:"group-sop"},[e._m(0),e._v(" "),a("div",{staticClass:"vue-search"},[a("el-form",{staticClass:"demo-form-inline",attrs:{"label-width":"140px"}},[a("el-form-item",{attrs:{label:"任务名称"}},[a("el-input",{staticStyle:{width:"30%"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否开启"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.form.is_open,callback:function(t){e.$set(e.form,"is_open",t)},expression:"form.is_open"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"选择执行人"}},[a("el-radio",{attrs:{label:1},model:{value:e.form.execution_type,callback:function(t){e.$set(e.form,"execution_type",t)},expression:"form.execution_type"}},[e._v("群主")]),e._v(" "),a("el-radio",{attrs:{label:2},model:{value:e.form.execution_type,callback:function(t){e.$set(e.form,"execution_type",t)},expression:"form.execution_type"}},[e._v("指定成员")]),e._v(" "),a("div",{staticClass:"tip"},[e._v("如指定的成员不在该群，默认群主转发")]),e._v(" "),2==e.form.execution_type?a("div",[a("div",{staticClass:"upload-box",on:{click:function(t){e.openChoice("成员",!1)}}},[a("i",{staticClass:"el-icon-plus",staticStyle:{"font-size":"32px"}}),e._v(" "),a("span",[e._v("选择成员")])]),e._v(" "),a("div",{staticClass:"choice-member"},e._l(e.search.executor,function(t,s){return a("span",[a("span",{staticClass:"row-card"},[a("i",{staticClass:"iconfont icon-fontclass-rengezhongxin",staticStyle:{color:"#29ba9c"}}),e._v("\n                    "+e._s(t.name)+"\n                    "),a("i",{staticClass:"el-icon-close",on:{click:function(t){e.delSelectMembers(s,"executor")}}})])])}))]):e._e()],1)],1)],1)]),e._v(" "),a("div",{staticClass:"group-sop"},[e._m(1),e._v(" "),a("div",{staticClass:"vue-search"},[a("el-form",{staticClass:"demo-form-inline",attrs:{"label-width":"140px"}},[a("el-form-item",{attrs:{label:"类型条件"}},[a("el-radio",{attrs:{label:1},on:{change:e.changeRadioType},model:{value:e.search.group_type,callback:function(t){e.$set(e.search,"group_type",t)},expression:"search.group_type"}},[e._v("指定群聊")]),e._v(" "),a("el-radio",{attrs:{label:2},on:{change:e.changeRadioType},model:{value:e.search.group_type,callback:function(t){e.$set(e.search,"group_type",t)},expression:"search.group_type"}},[e._v("条件筛选")])],1),e._v(" "),2==e.search.group_type?a("el-form-item",{attrs:{label:"选择类型"}},[a("el-radio",{attrs:{label:1},on:{change:e.changeRadioType},model:{value:e.search.target_type,callback:function(t){e.$set(e.search,"target_type",t)},expression:"search.target_type"}},[e._v("选择群主")]),e._v(" "),a("el-radio",{attrs:{label:2},on:{change:e.changeRadioType},model:{value:e.search.target_type,callback:function(t){e.$set(e.search,"target_type",t)},expression:"search.target_type"}},[e._v("选择群成员")]),e._v(" "),a("el-radio",{attrs:{label:3},on:{change:e.changeRadioType},model:{value:e.search.target_type,callback:function(t){e.$set(e.search,"target_type",t)},expression:"search.target_type"}},[e._v("选择群标签")])],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:1==e.search.group_type?"选择群聊":"选择条件"}},[1==e.search.group_type?a("el-button",{attrs:{plain:""},on:{click:function(t){e.openChoice("群聊",!1)}}},[e._v("选择群聊")]):e._e(),e._v(" "),2==e.search.group_type&&1==e.search.target_type?a("el-button",{attrs:{plain:""},on:{click:function(t){e.openChoice("群主",!1)}}},[e._v("选择群主")]):e._e(),e._v(" "),2==e.search.group_type&&2==e.search.target_type?a("el-button",{attrs:{plain:""},on:{click:function(t){e.openChoice("群成员",!1)}}},[e._v("选择群成员")]):e._e(),e._v(" "),2==e.search.group_type&&3==e.search.target_type?a("el-button",{attrs:{plain:""},on:{click:function(t){e.openChoice("群标签",!1)}}},[e._v("选择群标签")]):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:" "}},[a("div",{staticClass:"choice-member"},e._l(e.search.target_list,function(t,s){return a("span",[a("span",{staticClass:"row-card"},[a("i",{staticClass:"iconfont icon-fontclass-rengezhongxin",staticStyle:{color:"#29ba9c"}}),e._v("\n                  "+e._s(t.group_name?t.group_name:t.name?t.name:t.tag_name)+"\n                  "),a("i",{staticClass:"el-icon-close",on:{click:function(t){e.delSelectMembers(s,"target_list")}}})])])}))]),e._v(" "),a("el-form-item",{attrs:{label:"推送时间"}},[a("div",{staticClass:"send-time"},[a("div",[a("el-radio",{attrs:{label:1},on:{change:e.changeRadio},model:{value:e.search.send_date_type,callback:function(t){e.$set(e.search,"send_date_type",t)},expression:"search.send_date_type"}},[e._v("任务创建后")])],1),e._v(" "),a("div",{staticClass:"send-time-box"},[e._v("每"),a("el-input",{staticStyle:{"min-width":"65px"},attrs:{oninput:"value=value.replace(/[^\\d]/g,'')"},nativeOn:{input:function(t){e.changeInput(t,"time_day1")}},model:{value:e.time_day1,callback:function(t){e.time_day1=t},expression:"time_day1"}}),e._v("天")],1),e._v(" "),a("div",{staticClass:"send-day"},[e._v("\n                当天\n                "),a("el-select",{staticClass:"send-select",attrs:{clearable:"",filterable:""},model:{value:e.time_hour1,callback:function(t){e.time_hour1=t},expression:"time_hour1"}},[a("el-option",{attrs:{label:"每天00:00",value:"00:00"}}),e._v(" "),e._l(24,function(e){return a("el-option",{key:e,attrs:{label:"每天"+e+":00",value:e+":00"}})})],2),e._v("\n                推送\n              ")],1),e._v(" "),a("div",[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"结束时间"},model:{value:e.search.end_date,callback:function(t){e.$set(e.search,"end_date",t)},expression:"search.end_date"}}),e._v(" "),a("div",{staticClass:"tip"},[e._v("如不设置结束日期需手动关闭任务")])],1)]),e._v(" "),a("div",{staticClass:"send-time"},[a("div",[a("el-radio",{attrs:{label:2},on:{change:e.changeRadio},model:{value:e.search.send_date_type,callback:function(t){e.$set(e.search,"send_date_type",t)},expression:"search.send_date_type"}},[e._v("任务创建后")])],1),e._v(" "),a("div",{staticClass:"send-time-box"},[a("el-input",{staticStyle:{"min-width":"65px"},attrs:{oninput:"value=value.replace(/[^\\d]/g,'')"},nativeOn:{input:function(t){e.changeInput(t,"time_day2")}},model:{value:e.time_day2,callback:function(t){e.time_day2=t},expression:"time_day2"}}),a("div",{staticStyle:{"min-width":"28px"}},[e._v("天后")])],1),e._v(" "),a("div",{staticClass:"send-day"},[e._v("\n                当天\n                "),a("el-select",{staticClass:"send-select",attrs:{clearable:"",filterable:""},model:{value:e.time_hour2,callback:function(t){e.time_hour2=t},expression:"time_hour2"}},[a("el-option",{attrs:{label:"每天00:00",value:"00:00"}}),e._v(" "),e._l(24,function(e){return a("el-option",{key:e,attrs:{label:"每天"+e+":00",value:e+":00"}})})],2),e._v("\n                推送\n              ")],1)]),e._v(" "),a("div",{staticStyle:{display:"flex","margin-top":"20px"}},[a("div",[a("el-radio",{attrs:{label:3},on:{change:e.changeRadio},model:{value:e.search.send_date_type,callback:function(t){e.$set(e.search,"send_date_type",t)},expression:"search.send_date_type"}},[e._v("任务创建后")])],1),e._v(" "),a("div",{staticClass:"send-time-box"},[a("el-input",{staticStyle:{"min-width":"65px"},attrs:{oninput:"value=value.replace(/[^\\d]/g,'')"},nativeOn:{input:function(t){e.changeInput(t,"after_hour")}},model:{value:e.search.after_hour,callback:function(t){e.$set(e.search,"after_hour",t)},expression:"search.after_hour"}}),a("div",{staticStyle:{"min-width":"28px"}},[e._v("小时")])],1),e._v(" "),a("div",{staticStyle:{width:"18%",display:"flex","margin-right":"10px"}},[a("el-input",{staticStyle:{"min-width":"150px"},attrs:{oninput:"value=value.replace(/[^\\d]/g,'')"},nativeOn:{input:function(t){e.changeInput(t,"after_min")}},model:{value:e.search.after_min,callback:function(t){e.$set(e.search,"after_min",t)},expression:"search.after_min"}}),a("div",{staticStyle:{"min-width":"180px"}},[e._v("分钟后推送")])],1)])]),e._v(" "),2==e.search.group_type?a("el-form-item",{attrs:{label:"排除群聊"}},[a("el-button",{attrs:{plain:""},on:{click:function(t){e.openChoice("群聊",!0)}}},[e._v("选择群聊")])],1):e._e(),e._v(" "),2==e.search.group_type?a("el-form-item",{attrs:{label:" "}},[a("div",{staticClass:"choice-member"},e._l(e.search.exclude_group,function(t,s){return a("span",[a("span",{staticClass:"row-card"},[a("i",{staticClass:"iconfont icon-fontclass-rengezhongxin",staticStyle:{color:"#29ba9c"}}),e._v("\n                  "+e._s(t.group_name)+"\n                  "),a("i",{staticClass:"el-icon-close",on:{click:function(t){e.delSelectMembers(s,"exclude_group")}}})])])}))]):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"所选群聊数"}},[e.isShowGroupNum?a("span",[e._v(e._s(e.groupNum))]):e._e(),e._v(" "),e.isShowGroupNum?e._e():a("span",{staticClass:"group-num",on:{click:function(t){e.submit("plugin/SopTask/checkGroupChat","checkNum")}}},[e._v("查看群数量")])]),e._v(" "),a("el-form-item",{attrs:{label:"任务内容设置"}},[e.info_show?a("content_card",{ref:"content_card",attrs:{textState:"more",avatar:e.avatar,testSlogan:e.testSlogan,nicknameList:e.nicknameList,dataShowList:e.dataShowList,styleContext:e.styleContext}}):e._e()],1)],1)],1)]),e._v(" "),a("div",{staticClass:"send-buttons"},[a("el-button",{staticStyle:{background:"#5ab79c","border-color":"#5ab79c"},attrs:{type:"primary"},on:{click:function(t){e.submit("plugin/SopTask/saveTask","submit")}}},[e._v("提交")])],1),e._v(" "),e.selectMemberVisible?a("select_member_dialog",{attrs:{titleName:e.titleName,axiosUrl:e.axiosUrl,selectMemberVisible:e.selectMemberVisible},on:{memberList:e.getMemberList,selectMemberData:e.getSelectMemberData,selectMemberList:e.selectMemberList}}):e._e()],1)],1)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"vue-main-title"},[t("div",{staticClass:"vue-main-title-left"}),this._v(" "),t("div",{staticClass:"vue-main-title-content"},[this._v("基础设置")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"vue-main-title"},[t("div",{staticClass:"vue-main-title-left"}),this._v(" "),t("div",{staticClass:"vue-main-title-content"},[this._v("任务设置")])])}],!1,null,"2ba64678",null));k.options.__file="group_sop_editor.vue";t.default=k.exports},QYaY:function(e,t,a){},"RU/L":function(e,t,a){a("Rqdy");var s=a("WEpk").Object;e.exports=function(e,t,a){return s.defineProperty(e,t,a)}},Rqdy:function(e,t,a){var s=a("Y7ZC");s(s.S+s.F*!a("jmDH"),"Object",{defineProperty:a("2faE").f})},SEkw:function(e,t,a){e.exports={default:a("RU/L"),__esModule:!0}},YEIV:function(e,t,a){"use strict";t.__esModule=!0;var s=function(e){return e&&e.__esModule?e:{default:e}}(a("SEkw"));t.default=function(e,t,a){return t in e?(0,s.default)(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},bZdz:function(e,t,a){e.exports=a.p+"static/img/welcome_top.d6767fe.png"},eKCi:function(e,t,a){"use strict";var s=a("QYaY");a.n(s).a},fW1p:function(e,t,a){var s=a("Y7ZC"),i=a("E8gZ")(!1);s(s.S,"Object",{values:function(e){return i(e)}})},gzmU:function(e,t,a){"use strict";var s=a("uRUB");a.n(s).a},jo6Y:function(e,t,a){"use strict";t.__esModule=!0,t.default=function(e,t){var a={};for(var s in e)t.indexOf(s)>=0||Object.prototype.hasOwnProperty.call(e,s)&&(a[s]=e[s]);return a}},nhzr:function(e,t,a){a("fW1p"),e.exports=a("WEpk").Object.values},uRUB:function(e,t,a){}}]);